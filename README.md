This code is absolutely atrocious, I know, I'm gonna clean it up soonâ„¢.